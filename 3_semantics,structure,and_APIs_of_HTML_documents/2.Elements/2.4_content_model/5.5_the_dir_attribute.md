# 3.2.5.5. The dir attribute

- dir属性は、要素のテキストの方向性を指定します。
- 属性は、次のキーワードと状態を持つ列挙型属性(enumerated attribute)です。
    - ltr状態にマップするltrキーワード
        - 要素の内容が、左から右のテキストの方向性に明確に分離されていることを示します。
    - rtl状態にマップするrtlキーワード
        - 要素の内容が、右から左のテキストの方向性に明確に分離されていることを示します。
    - auto状態にマップするautoキーワード
        - 要素の内容が明示的に方向的に分離されたテキストであることを示します。
        - その方向は要素の内容を使用してプログラムで決定される

***
### note
- この状態で使用されるヒューリスティックは非常に粗いです
    - 双方向アルゴリズムの段落レベル決定と同様の方法で、強い方向性を持つ最初の文字を見るだけです
- 制作者には、テキストの方向が本当に不明で、サーバー側ヒューリスティックを適用することができない場合にのみ、この値を最後の手段として使用することを強く推奨します。
***

***
### note
- textareaとpre要素の場合、ヒューリスティックは段落単位で適用されます。
***

- 属性には無効な値の既定値がなく、既定値の欠損値はありません。

***

- 要素（HTML要素だけでなく、要素）の方向性は、ltrまたはrtlのいずれかであり、次のリストの最初の適切なステップセットとして決定されます。


- 要素のdir属性がltr状態にある場合
- 要素がdocument要素であり、dir属性が定義された状態にない（すなわち、存在しないか、または無効な値を有する）
- 要素のtype属性がTelephone状態であるinput要素でdir属性が定義された状態でない（すなわち、存在しないか、または値が無効である）入力要素である場合、
    - 要素の方向性は「ltr」である。

- 要素のdir属性がrtl状態にある場合
    - 要素の方向性は「rtl」である。

- 要素のタイプ属性がtext, search, telephone, url, e-mailの状態にあるinput要素で、dir属性がauto状態である場合
- 要素がtextarea要素で、dir属性がauto状態の場合
    - 要素の値に双方向文字型ALまたはRの文字が含まれていて、その要素の値の前に双方向文字型Lの文字がない場合、要素の方向性は 'rtl'です。
        -  [BIDI](https://www.w3.org/TR/html/references.html#biblio-bidi)
    - それ以外の場合、要素の値が空の文字列でない場合、または要素がドキュメント要素の場合、要素の方向性は 'ltr'です。
    - それ以外の場合、要素の方向性は要素の親要素の方向性と同じです。

- 要素のdir属性がauto状態の場合
- 要素がbdi要素であり、dir属性が定義済みの状態にない（つまり、存在しないか、無効な値を持っている）
    - 次の基準に一致する最初の文字をツリー順に探します。
        - 文字は、方向性が決定されている要素の子孫であるTextノードからの文字
        - 文字は、双方向文字タイプL、AL、またはRです。
            - [BIDI](https://www.w3.org/TR/html/references.html#biblio-bidi)
        - キャラクタは、方向性が決定されている要素の子孫である祖先要素を持つテキストノード内にはなく、次のいずれかです。
             - `<bdi>`要素
             - `<script>`要素
             - `<style>`要素
             - `<textarea>`要素
             - dir属性のある要素

- そのような文字が見つかった場合、それは双方向文字型ALまたはRであり、要素の方向性は 'rtl'です。
- そのような文字が見つかってそれが双方向文字タイプLである場合、要素の方向性は 'ltr'です。
- それ以外の場合、要素の方向性は要素の親要素の方向性と同じです。


- 要素に親要素があり、dir属性が定義済みの状態でない場合
    - 存在しないか、または無効な値を有する場合
        - 要素の方向性は、要素の親要素の方向性と同じです。

***
### note
- dir属性はHTML要素に対してのみ定義されるため、他の名前空間の要素には存在できません。
    - したがって、他の名前空間の要素は、常に親要素から方向性を継承します。存在しない場合は、デフォルトで 'ltr'になります。
***

***
### note
- この属性には、双方向アルゴリズムに関するレンダリング要件があります。
***

- 属性のテキストが何らかの形でレンダリングに含まれるべきであるときに使用されるHTML要素の属性の方向性は、以下のリストから第1の適切なステップのセットに従って決定される


- 属性が方向性対応属性であり、要素のdir属性がauto状態の場合
    - 双方向文字型L、AL、またはRの属性値の最初の文字（論理的順序）を探します。
        - [BIDI](https://www.w3.org/TR/html/references.html#biblio-bidi)
    - そのような文字が見つかった場合、それは双方向文字タイプALまたはRであり、属性の方向性は 'rtl'です。
    - それ以外の場合は、属性の方向性は「ltr」です。
- それ以外の場合
    - 属性の方向性は要素の方向性と同じです。


- 次の属性は、方向性対応属性です
    - `<th>`要素のabbr属性
    - `<area>`, `<img>`, `<input>`要素のalt属性
    - `<meta>`要素のcontent属性
        - name属性が、値がマシンリーダブルではなく人間が読めるように意図されているメタデータ名を指定している場合
    - `<optgroup>`, `<option>`, `<track>`要素のlabel属性
    - `<textarea>`, `<input>`要素のplaceholder属性
    - HTML要素のtitle属性



***

#### document.dir [=value]
    - この定義は非規範的です。 実装要件はこの定義の下で与えられます。
    - 存在する場合、`<html>`要素のdir属性の値を返す
    - 'ltr'、 'rtl'、または 'auto'のいずれかに設定して、html要素のdir属性の値を置き換えることができます。
    - html要素がない場合、空の文字列を返し、新しい値を無視します。

***

- 要素のdir IDL属性は、その要素のdir属性を反映する必要があり、既知の値のみに制限されます。
- Documentオブジェクトのdir IDL属性は、html要素のdir属性がある場合、反映させる必要があり、既知の値のみに制限されます。
    - そのような要素がない場合、属性は空の文字列を返す必要があり、設定には何もしません。


***
### note:
- 制作者は、CSSを使用するのではなく、テキストの方向を示すためにdir属性を使用することを強く推奨します。
    - これは、CSSの不在時でもドキュメントが正しくレンダリングされ続けるためです
    - 検索エンジンによって解釈される場合など
***


```html
<!-- 例19:
このマークアップ・フラグメントは、IM会話のものです。 -->
<p dir=auto class="u1"><b><bdi>Student</bdi>:</b> How do you write "What’s your name?" in Arabic?</p>
<p dir=auto class="u2"><b><bdi>Teacher</bdi>:</b> ما اسمك؟</p>
<p dir=auto class="u1"><b><bdi>Student</bdi>:</b> Thanks.</p>
<p dir=auto class="u2"><b><bdi>Teacher</bdi>:</b> That’s written "شكرًا".</p>
<p dir=auto class="u2"><b><bdi>Teacher</bdi>:</b> Do you know how to write "Please"?</p>
<p dir=auto class="u1"><b><bdi>Student</bdi>:</b> "من فضلك", right?</p>
```

<!--
適切なスタイルシートと、p要素のデフォルトの配置スタイル、
つまり段落の開始辺にテキストを揃えた場合、
結果のレンダリングは次のようになります。-->

<!--
前述のように、 'auto'値は万能薬ではありません。
この例の最後の段落は、右から左へのテキストであると誤解されています。
なぜなら、アラビア語の文字で始まるからです。
アラビア語のテキストの左側にあるように。
-->
```


![スクリーンショット 2018-10-18 23.02.22.png (24.1 kB)](https://img.esa.io/uploads/production/attachments/9099/2018/10/18/36903/7f59cb5e-2339-4a91-9f5a-8db5aae6caac.png)
