# 3.2.5.2. The lang and xml:lang attributes

- lang属性（ネームスペースなし）は、要素の内容とテキストを含む要素の属性のいずれかの主言語を指定します。
- その値は有効なBCP 47言語タグまたは空文字列でなければなりません。
- 属性を空の文字列に設定すると、主要言語が不明(unknown)であることが示されます。
    - [BCP 47](https://www.w3.org/TR/html/references.html#biblio-bcp47)

- XML名前空間のlang属性はXMLで定義されています
    - [XML](https://www.w3.org/TR/html/references.html#biblio-xml)

- これらの属性が要素から省略されている場合、この要素の言語は、その親要素の言語と同じです（存在する場合）。

- ネームスペースのないlang属性は、どのHTML要素でも使用できます。

- XMLネームスペースのlang属性は、XMLドキュメントのHTML要素や、関連する仕様で許可されている場合は他の名前空間の要素で使用できます
    - 特に、MathMLとSVGは、XML名前空間内のlang属性をその要素に指定できるようにします
- 名前空間のないlang属性とXML名前空間のlang属性の両方が同じ要素に指定されている場合、case-insensitiveで、まったく同じ値を持たなければなりません。

- 作成者は、HTML文書のHTML要素のXML名前空間でlang属性を使用してはなりません。
- XHTMLへのまたはXHTMLからの移行を容易にするために、著者は、HTMLドキュメント内のHTML要素にプレフィックスを持たず、リテラルローカル名 "xml:lang"を持つ名前空間のない属性を指定することができます。
    - しかし、そのような属性は、名前空間のないlang属性も指定されている場合にのみ指定する必要があります。
        - さらにcase-insensitiveな両方の属性が同じ値を持たなければなりません。

***
### note
- プリフィクスがなく、名前空間のないリテラルのローカル名 "xml:lang"は、言語処理に影響しません。
***

***
### warning
- HTML文書の言語は、lang属性を使用して示されます
    - html要素自体に、文書の主要な言語や個々の要素を指定して言語の変更を示す
    - これは、言語特有の動作を可能にするために、コンテンツの言語についてユーザエージェントに明示的に指示する。
    - 例えば、適切な言語辞書の使用。
    - 音声出力を備えたスクリーンリーダーや同様の補助技術の場合は、正しい音声/言語ライブラリを使用したコンテンツの発音が可能です。
- 不正なlang属性またはlang属性が無いことは、他の状況で予期しない結果を生成する可能性があります。
    - q要素の引用符、ハイフネーション、大文字小文字の変換、改行、一部のエディタでのスペルチェックなどのスタイリングを決定するためにも使用されるためです。
- lang属性をドキュメントまたはドキュメントパーツの言語と一致しない言語に設定すると、一部のユーザーがそのコンテンツを理解できなくなります。
***

- ノードの言語を特定するには、uaは、XML名前空間集合にlang属性を持つ、またはHTML要素であり、名前空間属性が設定されていないlangを持つ、最も近い祖先要素（ノードが要素の場合は要素自体を含む）を確認しないといけない。
- その属性は、その値に関係なく、ノードの言語を指定します。

- 名前空間のないlang属性とXML名前空間のlang属性の両方が要素に設定されている場合、要素の言語を決定するために名前空間のないlang属性を無視しなければなりません。
- ノードの包含的な祖先にいずれかの属性が設定されていないが、プラグマセットのデフォルト言語が設定されている場合は、それがノードの言語です。
- プラグマセットのデフォルト言語が設定されていない場合、上位プロトコル（HTTPなど）からの言語情報がある場合は、代わりに最終的なフォールバック言語として使用する必要があります。
- そのような言語情報が存在しない場合、および上位プロトコルが複数の言語を報告する場合、ノードの言語は不明であり、対応する言語タグは空文字列である。

```
例:16
たとえば、ドキュメントがHTTP経由で配信され、
Content-Language HTTPヘッダーが値「en」で指定されている場合、
文書内のlang属性もその要素の祖先も持たない要素の場合、
要素のフォールバック言語は英語になります。
Content-Languageヘッダーの値が "de、fr、it"の場合、ノードの言語は不明です。
この記事では、HTTPヘッダーと言語情報を提供するための
メタ要素の使用に関する追加のガイダンスを提供します。
```

- 結果の値が認識された言語タグでない場合は、他のすべての言語とは異なる、指定された言語タグを持つ未知の言語として扱われなければなりません。
- ラウンドトリップまたは言語タグを期待する他のサービスとの通信の目的で、uaはunknownの言語タグを未変更で渡し、BCP47言語タグとしてタグ付けする必要があります。そのため後続のサービスはデータを別のタイプの言語記述として解釈しません。
    - [BCP47](https://www.w3.org/TR/html/references.html#biblio-bcp47)


```
例:17
したがって、たとえば、lang = "xyzzy"の要素はセレクタ：lang（xyzzy）
（たとえばCSS）と一致しますが、lang（abcde）と、
両方無効な値にかかわらず一致しません。
同様に、Webブラウザーと画面リーダーが要素の言語について
一致して作業している場合、
たとえ無効な言語だとわかっていたとしても、
スクリーンリーダーが実際にそのタグの言語をサポートしていた場合に備えて
ブラウザーは、言語が「xyzzy」であることをスクリーンリーダーに伝えます。
スクリーンリーダーがBCP 47と言語名をエンコードするための
別の構文の両方をサポートしていて、
他の構文で文字列 "xyzzy"がベラルーシ語を示す方法であった場合、
「xyzzy」はベラルーシ語がBCP 47コードで記述されている方法ではないため
（BCP 47はベラルーシ語で「be」というコードを使用しているため）、
スクリーンリーダーがベラルーシ語としてテキストを扱うのは間違いです。
```

- 結果の値が空の文字列である場合、ノードの言語が明示的に未知であることを意味するものとして解釈されなければならない。

***

- uaは、要素の言語を使用して適切な処理やレンダリングを決定することができる
    - 適切なフォントまたは発音の選択、辞書の選択、日付選択のようなフォームコントロールのユーザーインターフェイス

- lang IDL属性は、名前空間のないlangコンテンツ属性を反映する必要があります。
